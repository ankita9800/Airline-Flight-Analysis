"0",""
"0","# Select the first year, and pick out the delay rate"
"0","DE20191 = df %>% "
"0","  filter(Day.of.month >= ""2019-01-01"" & Day.of.month<= ""2019-02-28"") %>% "
"0","  select(`Air Carrier Name`,DEP_DEL15)%>%"
"0","  filter(DEP_DEL15 == 1)%>%"
"0","  group_by(`Air Carrier Name`)%>%"
"0","  summarise(Value=n()) %>%"
"0","  arrange(desc(Value)) "
"0",""
"0","# Group by column name and find delay calculated earlier"
"0","DE20192 = df %>% "
"0","  select(`Air Carrier Name`)%>%"
"0","  group_by(`Air Carrier Name`)%>%"
"0","  summarise(Value1=n()) %>%"
"0","  arrange(desc(Value1))"
"0",""
"0","#Left join"
"0","DE2019=left_join(DE20191,DE20192, by= 'Air Carrier Name')"
"0",""
"0","#Delay rate"
"0","DE2019$`AVERAGE DELAY` = DE2019$Value/DE2019$Value1"
"0",""
"0","#modify name"
"0","colnames(DE2019)[2] = ""Delayed Flight"""
"0","colnames(DE2019)[3] = ""Total flight"""
"0",""
"0","# Plot Top 5 Air carrier company with the highest delay rate in 2019"
"0","DE2019 %>% "
"0","  arrange(desc(`AVERAGE DELAY`)) %>% "
"0","  top_n(5) %>% "
"0","  ggplot(aes(x=reorder(`Air Carrier Name`,-`AVERAGE DELAY`), "
"0","             y=`AVERAGE DELAY`, color=`AVERAGE DELAY`, fill=`AVERAGE DELAY`)) + "
"0","  geom_bar(stat = ""identity"") +"
"0","  ggtitle(""Top 5 Air carrier company with the highest delay rate in 2019"")+"
"0","  labs(x= ""Air carrier"", y= ""delay rate"")+"
"0","  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))"
