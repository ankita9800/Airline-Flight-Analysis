"0",""
"0","# Select the second year, and pick out the delay rate"
"0","DE20201 = df %>% "
"0","  filter(Day.of.month >= ""2020-01-01"" & Day.of.month<= ""2020-02-29"") %>% "
"0","  select(`Air Carrier Name`,DEP_DEL15)%>%"
"0","  filter(DEP_DEL15 == 1)%>%"
"0","  group_by(`Air Carrier Name`)%>%"
"0","  summarise(Value=n()) %>%"
"0","  arrange(desc(Value)) "
"0",""
"0","# Group by column name and find delay calculated earlier"
"0","DE20202 = df %>% "
"0","  select(`Air Carrier Name`)%>%"
"0","  group_by(`Air Carrier Name`)%>%"
"0","  summarise(Value1=n()) %>%"
"0","  arrange(desc(Value1))"
"0",""
"0","# Left join"
"0","DE2020=left_join(DE20201,DE20202, by= 'Air Carrier Name')"
"0",""
"0","# Calculate delay rate"
"0","DE2020$`AVERAGE DELAY2` = DE2020$Value/DE2020$Value1"
"0",""
"0","# Rename column"
"0","colnames(DE2020)[2] = ""Delayed Flight2"""
"0","colnames(DE2020)[3] = ""Total flight2"""
"0",""
"0","# Top 5 Air carrier company with the highest delay rate in 2020"
"0","DE2020 %>% "
"0","  arrange(desc(`AVERAGE DELAY2`)) %>% "
"0","  top_n(5) %>% "
"0","  ggplot(aes(x=reorder(`Air Carrier Name`,-`AVERAGE DELAY2`),"
"0","             y=`AVERAGE DELAY2`, color=`AVERAGE DELAY2`, fill=`AVERAGE DELAY2`)) + "
"0","  geom_bar(stat = ""identity"") +"
"0","  ggtitle(""Top 5 Air carrier company with the highest delay rate in 2020"")+"
"0","  labs(x= ""Air carrier"", y= ""delay rate"")+"
"0","  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))"
